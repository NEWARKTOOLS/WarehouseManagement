{% extends "base.html" %}

{% block title %}Maintenance Due{% endblock %}

{% block content %}
<div class="container-fluid px-3 px-md-4">
    <div class="page-header">
        <h1><i class="bi bi-tools me-2"></i>Maintenance Due</h1>
    </div>

    {% if due_moulds %}
    <div class="card mb-4">
        <div class="card-header bg-danger text-white">
            <i class="bi bi-exclamation-triangle me-2"></i>Overdue ({{ due_moulds|length }})
        </div>
        <div class="card-body p-0">
            <div class="list-group list-group-flush">
                {% for mould in due_moulds %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <a href="{{ url_for('moulds.mould_detail', mould_id=mould.id) }}">
                            <strong>{{ mould.mould_number }}</strong>
                        </a>
                        - {{ mould.name or 'No name' }}
                        <br>
                        <small class="text-muted">Due: {{ mould.next_maintenance_date.strftime('%d/%m/%Y') }}</small>
                    </div>
                    <a href="{{ url_for('moulds.record_maintenance', mould_id=mould.id) }}" class="btn btn-sm btn-success">
                        Record PM
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    {% if upcoming %}
    <div class="card">
        <div class="card-header bg-warning">
            <i class="bi bi-clock me-2"></i>Due Within 30 Days ({{ upcoming|length }})
        </div>
        <div class="card-body p-0">
            <div class="list-group list-group-flush">
                {% for mould in upcoming %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <a href="{{ url_for('moulds.mould_detail', mould_id=mould.id) }}">
                            <strong>{{ mould.mould_number }}</strong>
                        </a>
                        - {{ mould.name or 'No name' }}
                        <br>
                        <small class="text-muted">Due: {{ mould.next_maintenance_date.strftime('%d/%m/%Y') }}</small>
                    </div>
                    <a href="{{ url_for('moulds.record_maintenance', mould_id=mould.id) }}" class="btn btn-sm btn-outline-success">
                        Record PM
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    {% if not due_moulds and not upcoming %}
    <div class="empty-state">
        <i class="bi bi-check-circle text-success"></i>
        <p>All moulds are up to date with maintenance!</p>
    </div>
    {% endif %}
</div>
{% endblock %}
